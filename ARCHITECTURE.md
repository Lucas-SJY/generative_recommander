# Amazon æ¨èç³»ç»Ÿ - æ¶æ„ä¸å®ç°è¯¦è§£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
2. [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
3. [æ•°æ®æµ](#æ•°æ®æµ)
4. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
5. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Web æµè§ˆå™¨                               â”‚   â”‚
â”‚  â”‚           (http://0.0.0.0:8001)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                   â”‚  HTTP/REST                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚    â”‚     FastAPI åº”ç”¨ (backend/main.py)            â”‚  â”‚   â”‚
â”‚  â”‚    â”‚     ç«¯å£: 8000                                 â”‚  â”‚   â”‚
â”‚  â”‚    â”‚  - æ¨è API: /api/recommend                   â”‚  â”‚   â”‚
â”‚  â”‚    â”‚  - å¯¹è¯ API: /api/chat                        â”‚  â”‚   â”‚
â”‚  â”‚    â”‚  - è¯¦æƒ… API: /api/item-details               â”‚  â”‚   â”‚
â”‚  â”‚    â”‚  - å¥åº·æ£€æŸ¥: /health                         â”‚  â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚       â”‚                               â”‚               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ RecommendationEngineâ”‚     â”‚  OllamaClient       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                     â”‚     â”‚                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ - ç†è§£ç”¨æˆ·æŸ¥è¯¢      â”‚     â”‚ - LLM ç”Ÿæˆæ–‡æœ¬     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ - å‘é‡ç›¸ä¼¼æœç´¢      â”‚     â”‚ - æ–‡æœ¬ Embedding   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ - æ’åºæ¨è          â”‚     â”‚ - æ‰¹é‡å¤„ç†         â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚       â”‚                               â”‚               â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â”‚                       â”‚                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                    â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚          â–¼               â–¼               â–¼                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚ PostgreSQL  â”‚â”‚ Ollama LLM   â”‚â”‚ Ollama       â”‚        â”‚
â”‚    â”‚ + pgvector  â”‚â”‚ qwen2.5:14b  â”‚â”‚ Embedding    â”‚        â”‚
â”‚    â”‚             â”‚â”‚              â”‚â”‚ nomic-embed  â”‚        â”‚
â”‚    â”‚ å‘é‡ç´¢å¼•    â”‚â”‚ æ–‡æœ¬ç”Ÿæˆ     â”‚â”‚ æ–‡æœ¬å‘é‡åŒ–   â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¯·æ±‚æµç¨‹

```
ç”¨æˆ·è¾“å…¥ (è‡ªç„¶è¯­è¨€)
    â†“
[å‰ç«¯] å‘é€è¯·æ±‚åˆ° /api/chat
    â†“
[åç«¯] RecommendationEngine.understand_query()
    â”œâ”€ LLM åˆ†æç”¨æˆ·æ„å›¾
    â””â”€ æå–å…³é”®è¯
    â†“
[åç«¯] OllamaClient.embed_text()
    â”œâ”€ å°†æ„å›¾è½¬æ¢ä¸ºå‘é‡
    â””â”€ ç»´åº¦: 768
    â†“
[æ•°æ®åº“] pgvector ç›¸ä¼¼æ€§æœç´¢
    â”œâ”€ è®¡ç®— embedding <=> query_embedding
    â”œâ”€ ä½¿ç”¨ HNSW ç´¢å¼•åŠ é€Ÿ
    â””â”€ è¿”å› TopK ç›¸ä¼¼å•†å“
    â†“
[åç«¯] æ’åºå’Œè¿‡æ»¤
    â””â”€ è¿”å› TopN æ¨è
    â†“
[åç«¯] OllamaClient.generate_text()
    â””â”€ ç”Ÿæˆå‹å¥½çš„æ¨èæè¿°
    â†“
[å‰ç«¯] æ˜¾ç¤ºæ¨èå’Œå¯¹è¯
    â””â”€ æ›´æ–° UI
```

---

## æ ¸å¿ƒæ¨¡å—

### 1. æ¨èå¼•æ“ (recommendation_engine.py)

**ä¸»è¦ç±»ï¼š`RecommendationEngine`**

```python
class RecommendationEngine:
    def understand_query(user_query: str) -> Tuple[str, List[str]]:
        """ä½¿ç”¨ LLM ç†è§£ç”¨æˆ·æŸ¥è¯¢
        
        è¿”å›:
            - intent: ç”¨æˆ·æ„å›¾æè¿°
            - keywords: æå–çš„å…³é”®è¯åˆ—è¡¨
        """
        
    def search_similar_items(query_embedding: List[float], limit: int) -> List[Dict]:
        """å‘é‡ç›¸ä¼¼æ€§æœç´¢
        
        ä½¿ç”¨ pgvector çš„ HNSW ç´¢å¼•åœ¨ O(log n) æ—¶é—´å†…æœç´¢
        è¿”å›ç›¸ä¼¼åº¦æœ€é«˜çš„ limit ä¸ªå•†å“
        """
        
    def generate_recommendations(user_query: str) -> List[Dict]:
        """å®Œæ•´çš„æ¨èæµç¨‹
        
        1. ç†è§£ç”¨æˆ·æŸ¥è¯¢
        2. åˆ›å»ºæŸ¥è¯¢å‘é‡
        3. æœç´¢ç›¸ä¼¼å•†å“
        4. è¿”å›æ’åºçš„æ¨èåˆ—è¡¨
        """
        
    def get_item_details(asin: str) -> Dict:
        """è·å–å•†å“è¯¦ç»†ä¿¡æ¯"""
```

### 2. Ollama å®¢æˆ·ç«¯ (ollama_client.py)

**ä¸»è¦ç±»ï¼š`OllamaClient`**

```python
class OllamaClient:
    def generate_text(prompt: str, system_prompt: Optional[str]) -> str:
        """LLM æ–‡æœ¬ç”Ÿæˆ
        
        - æ¨¡å‹: qwen2.5:14b
        - æ¸©åº¦: 0.7
        - æ”¯æŒ system prompt
        """
        
    def embed_text(text: str) -> List[float]:
        """å•ä¸ªæ–‡æœ¬ embedding
        
        - æ¨¡å‹: nomic-embed-text
        - è¾“å‡ºç»´åº¦: 768
        - è¿”å›æµ®ç‚¹å‘é‡
        """
        
    def embed_batch(texts: List[str]) -> List[List[float]]:
        """æ‰¹é‡ embedding
        
        - é«˜æ•ˆå¤„ç†å¤šä¸ªæ–‡æœ¬
        - è¿”å›å‘é‡åˆ—è¡¨
        """
```

### 3. æ•°æ®åº“æ¨¡å‹ (models.py)

**æ ¸å¿ƒè¡¨ç»“æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       items              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ asin (PK)               â”‚
â”‚ title, category         â”‚
â”‚ brand, price            â”‚
â”‚ rating_avg, rating_countâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼          â–¼          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚embeddings  â”‚ â”‚reviews_summary â”‚ â”‚sessions      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚embedding   â”‚ â”‚pros, cons      â”‚ â”‚memory_json   â”‚
   â”‚(vector768) â”‚ â”‚summary_text    â”‚ â”‚updated_at    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ ç´¢å¼•: HNSW (cosine)
        â”‚
     (å¿«é€Ÿç›¸ä¼¼æœç´¢)
```

### 4. FastAPI åº”ç”¨ (main.py)

**ä¸»è¦ç«¯ç‚¹ï¼š**

| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| POST | `/api/recommend` | ç”Ÿæˆæ¨è |
| POST | `/api/chat` | å¤šè½®å¯¹è¯ |
| POST | `/api/item-details` | è·å–å•†å“è¯¦æƒ… |
| GET | `/health` | å¥åº·æ£€æŸ¥ |

---

## æ•°æ®æµ

### æ¨èæµç¨‹è¯¦è§£

```
ç”¨æˆ·: "æˆ‘æƒ³è¦ä¸€ä¸ªè½»ä¾¿çš„æ— çº¿å……ç”µå®"

â†“ [ç¬¬ä¸€æ­¥] ç†è§£æ„å›¾

LLM (qwen2.5:14b):
è¾“å…¥: "æˆ‘æƒ³è¦ä¸€ä¸ªè½»ä¾¿çš„æ— çº¿å……ç”µå®"
è¾“å‡º: {
    "intent": "å¯»æ‰¾è½»ä¾¿æ˜“æºå¸¦çš„æ— çº¿å……ç”µå®",
    "keywords": ["è½»ä¾¿", "æ— çº¿", "å……ç”µå®", "ä¾¿æº"]
}

â†“ [ç¬¬äºŒæ­¥] åˆ›å»ºæŸ¥è¯¢å‘é‡

Embedding (nomic-embed-text):
è¾“å…¥: "å¯»æ‰¾è½»ä¾¿æ˜“æºå¸¦çš„æ— çº¿å……ç”µå®"
è¾“å‡º: [0.123, -0.456, 0.789, ..., 0.321]  # 768 ç»´å‘é‡

â†“ [ç¬¬ä¸‰æ­¥] æœç´¢ç›¸ä¼¼å•†å“

PostgreSQL + pgvector:
SELECT * FROM items i
JOIN item_embeddings ie ON i.asin = ie.asin
ORDER BY ie.embedding <=> query_embedding::vector
LIMIT 80  (RETRIEVE_TOPK)

ä½¿ç”¨ HNSW ç´¢å¼•ï¼ŒO(log N) æ—¶é—´å¤æ‚åº¦

â†“ [ç¬¬å››æ­¥] è¿”å›å‰ 8 ä¸ª

Top-N æ’åº:
1. "Anker 20000mAh æ— çº¿å……ç”µå®" - similarity: 0.94
2. "Baseus 30W æ— çº¿å……ç”µå®" - similarity: 0.92
3. "å°ç±³ 10000mAh æ— çº¿å……ç”µå®" - similarity: 0.89
...

â†“ [ç¬¬äº”æ­¥] ç”Ÿæˆæè¿°

LLM:
è¾“å…¥: "ç”¨æˆ·éœ€æ±‚ + æ¨èåˆ—è¡¨"
è¾“å‡º: "æˆ‘ä¸ºæ‚¨æ¨èäº†å‡ æ¬¾é«˜è¯„åˆ†çš„æ— çº¿å……ç”µå®ï¼Œ
       éƒ½æ˜¯è½»ä¾¿ä¾¿æºçš„è®¾è®¡ï¼Œéå¸¸é€‚åˆæ‚¨..."
```

---

## æŠ€æœ¯æ ˆ

### åç«¯

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.9+ | ç¼–ç¨‹è¯­è¨€ |
| FastAPI | 0.104 | Web æ¡†æ¶ |
| SQLAlchemy | 2.0 | ORM |
| pgvector | 0.2.4 | å‘é‡æ•°æ®åº“ |
| psycopg | 3.17 | PostgreSQL é©±åŠ¨ |
| Pydantic | 2.5 | æ•°æ®éªŒè¯ |
| uvicorn | 0.24 | ASGI æœåŠ¡å™¨ |

### æ•°æ®åº“

| ç»„ä»¶ | ç”¨é€” |
|------|------|
| PostgreSQL 14+ | å…³ç³»æ•°æ®åº“ |
| pgvector æ‰©å±• | å‘é‡ç›¸ä¼¼æœç´¢ |
| HNSW ç´¢å¼• | å¿«é€Ÿå‘é‡æŸ¥è¯¢ |

### å¤§æ¨¡å‹ (Ollama)

| æ¨¡å‹ | ç”¨é€” | å‚æ•°é‡ |
|------|------|--------|
| qwen2.5:14b | æ–‡æœ¬ç”Ÿæˆ | 14B |
| nomic-embed-text | Embedding | 137M |

### å‰ç«¯

| ç»„ä»¶ | ç”¨é€” |
|------|------|
| HTML5 | æ ‡è®°è¯­è¨€ |
| CSS3 | æ ·å¼ |
| JavaScript (Vanilla) | äº¤äº’é€»è¾‘ |

---

## éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ

```bash
# 1. å…‹éš†/åˆå§‹åŒ–é¡¹ç›®
cd /home/lucas/ucsc/yi

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. ç¡®ä¿ PostgreSQL å’Œ Ollama è¿è¡Œ
# - PostgreSQL: psql -U postgres -d recsys
# - Ollama: ollama serve

# 4. åˆå§‹åŒ–æ•°æ®åº“
psql -U postgres -d recsys -f db/ddl/yddl.ddl

# 5. åŠ è½½æ•°æ®
python backend/load_data.py

# 6. å¯åŠ¨æœåŠ¡
python run.py
```

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **æ•°æ®åº“è¿æ¥æ± **
   - ä½¿ç”¨ pgBouncer ç®¡ç†è¿æ¥
   - é…ç½®è¿æ¥æ•°ä¸Šé™

2. **Ollama ä¼˜åŒ–**
   - ä½¿ç”¨ä¸“ç”¨ GPU æœåŠ¡å™¨
   - é…ç½®æ¨¡å‹ç¼“å­˜

3. **API ç¼“å­˜**
   - æ·»åŠ  Redis ç¼“å­˜å±‚
   - ç¼“å­˜çƒ­é—¨æŸ¥è¯¢çš„ç»“æœ

4. **ç›‘æ§å’Œæ—¥å¿—**
   - é›†æˆ ELK æˆ– Prometheus
   - è®°å½•å…³é”®æ“ä½œæ—¥å¿—

5. **è´Ÿè½½å‡è¡¡**
   - ä½¿ç”¨ Nginx/HAProxy
   - å¤šä¸ª API å®ä¾‹

---

## æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

```sql
-- æ£€æŸ¥å‘é‡ç´¢å¼•ä½¿ç”¨æƒ…å†µ
EXPLAIN ANALYZE
SELECT * FROM lmrc.item_embeddings
ORDER BY embedding <=> '[...]'::vector
LIMIT 80;

-- åˆ†æè¡¨ç»Ÿè®¡
ANALYZE lmrc.items;
ANALYZE lmrc.item_embeddings;

-- æŸ¥çœ‹ç´¢å¼•å¤§å°
SELECT 
    indexname,
    pg_size_pretty(pg_relation_size(indexrelid)) AS index_size
FROM pg_indexes
WHERE schemaname = 'lmrc'
ORDER BY pg_relation_size(indexrelid) DESC;
```

### Embedding ç¼“å­˜

```python
# ç¼“å­˜æµè¡ŒæŸ¥è¯¢çš„å‘é‡
cache = {}

def get_or_create_embedding(text: str):
    if text in cache:
        return cache[text]
    
    embedding = ollama_client.embed_text(text)
    cache[text] = embedding
    return embedding
```

### æ‰¹é‡ä¼˜åŒ–

```python
# æ‰¹é‡ç”Ÿæˆ embedding
embeddings = ollama_client.embed_batch([
    text1, text2, text3, ...
])

# æ‰¹é‡å†™å…¥æ•°æ®åº“
db.bulk_insert_mappings(ItemEmbedding, items)
db.commit()
```

---

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|--------|
| è¿æ¥ PostgreSQL å¤±è´¥ | æ•°æ®åº“æœªè¿è¡Œæˆ–é…ç½®é”™è¯¯ | æ£€æŸ¥ .envï¼Œç¡®ä¿ DB è¿è¡Œ |
| Ollama è¿æ¥å¤±è´¥ | Ollama æœåŠ¡æœªå¯åŠ¨ | `ollama serve` |
| æ¨¡å‹ä¸å­˜åœ¨ | æœªä¸‹è½½æ‰€éœ€æ¨¡å‹ | `ollama pull qwen2.5:14b` |
| æ¨èä¸ºç©º | æ²¡æœ‰æ•°æ®æˆ–å‘é‡ä¸åŒ¹é… | è¿è¡Œ `python backend/load_data.py` |
| API å“åº”æ…¢ | æ•°æ®é‡å¤§æˆ–ç´¢å¼•æœªä¼˜åŒ– | æ£€æŸ¥æŸ¥è¯¢è®¡åˆ’ï¼Œä¼˜åŒ–ç´¢å¼• |

### è°ƒè¯•

```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
python health_check.py

# æŸ¥çœ‹æ•°æ®åº“ç»Ÿè®¡
python db_utils.py

# æµ‹è¯•æ¨èåŠŸèƒ½
python dev_test.py "æˆ‘æƒ³è¦ä¸€ä¸ªå¥½çš„é”®ç›˜"

# æŸ¥çœ‹ API æ—¥å¿—
tail -f logs/backend.log
```

---

## æ‰©å±•ç‚¹

### æ·»åŠ æ–°çš„æ¨èç­–ç•¥

```python
# åœ¨ recommendation_engine.py ä¸­

class RecommendationEngine:
    def hybrid_search(self, user_query: str, use_tags: bool = True):
        """æ··åˆæœç´¢: å‘é‡ + æ ‡ç­¾
        
        ç»“åˆå‘é‡ç›¸ä¼¼åº¦å’Œæ ‡ç­¾åŒ¹é…
        """
        pass
    
    def personalized_recommend(self, user_id: str, query: str):
        """ä¸ªæ€§åŒ–æ¨è
        
        è€ƒè™‘ç”¨æˆ·å†å²è¡Œä¸º
        """
        pass
    
    def trending_items(self):
        """çƒ­é—¨å•†å“æ¨è
        
        åŸºäºè¯„è®ºæ•°å’Œè¯„åˆ†
        """
        pass
```

### é›†æˆæ›´å¤šæ•°æ®æº

```python
# æ·»åŠ å¤–éƒ¨æ•°æ®æº
class ExternalDataIntegration:
    def fetch_from_api(self, asin: str):
        """ä»å¤–éƒ¨ API è·å–æ•°æ®"""
        pass
    
    def enrich_metadata(self, items: List[Item]):
        """ä¸°å¯Œå•†å“ä¿¡æ¯"""
        pass
```

---

## å‚è€ƒèµ„æº

- [FastAPI æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [SQLAlchemy æ–‡æ¡£](https://docs.sqlalchemy.org/)
- [pgvector æ–‡æ¡£](https://github.com/pgvector/pgvector)
- [Ollama æ–‡æ¡£](https://github.com/ollama/ollama)
- [PostgreSQL æ–‡æ¡£](https://www.postgresql.org/docs/)

---

**ç‰ˆæœ¬**: 0.1.0  
**æœ€åæ›´æ–°**: 2026-01-15  
**ç»´æŠ¤è€…**: Your Name
